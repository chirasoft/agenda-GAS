<script>
    function crearTablaContactos() {
        // para que no se duplique las tablas
        let tabla = document.getElementById('tablaContactos');
        if (tabla) tabla.remove();
        google.script.run.withSuccessHandler(
            function (obj) {
                tabla = document.createElement('table');
                tabla.id = 'tablaContactos'
                let tablaBody = document.createElement('tbody');
                let tablaHeader = document.createElement('thead');
                for(let i=0;i<obj.length;i++)
                {
                    let fila = document.createElement('tr');
                    for(let j=0; j<obj[i].length;j++)
                    {
                        let celda = document.createElement('td');
                        celda.textContent = obj[i][j];
                        fila.appendChild(celda);
                    }
                    if (i == 0) {
                        tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    } else {
                        tablaBody.appendChild(fila);
                    } 
                }
                /*Array.from(obj).forEach((filaActual, i) => {
                    let fila = document.createElement('tr');
                    filaActual.forEach(celdaActual => {
                        let celda = document.createElement('td');
                        celda.textContent = celdaActual;
                        fila.appendChild(celda);
                    });
                    if (i == 0) {
                        tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    } else {
                        tablaBody.appendChild(fila);
                    }
                });*/
                // agregamos css al header
                tablaHeader.classList.add('table-dark')
                //agregamos el cuerpo a la tabla
                tabla.appendChild(tablaBody);
                //agregarmos clases a la tabla
                tabla.classList.add('table', 'table-striped', 'border-3', 'table-success');
                //  agregamos la tabla a la pagina web
                document.getElementById('divContactos').appendChild(tabla);
            }
        ).obtenerContactos();
    }
</script>