<script>
    // para los tipos de notificacion
    const NOTIFICACION_OK =1;
    const NOTIFICACION_DANGER =2;
    const NOTIFICACION_WARNING =3;

    function crearTablaContactos() 
    {
        // para que no se duplique las tablas
        let tabla = document.getElementById('tablaContactos');
        if (tabla) tabla.remove();
        google.script.run
        .withSuccessHandler(crearTblaContactoCorrectamente)
        .withFailureHandler(crearTablaContactosError)
        .obtenerContactos();
    }
    //funcion auxiliar
    function crearTblaContactoCorrectamente(obj) 
            {
                tabla = document.createElement('table');
                tabla.id = 'tablaContactos'
                let tablaBody = document.createElement('tbody');
                let tablaHeader = document.createElement('thead');
                //llenar cabecera
                let primeraFila = document.createElement('tr');
                for (let ii = 0; ii < obj[0].length; ii++) {
                    let celda = document.createElement('td');
                    celda.textContent = obj[0][ii];
                    primeraFila.appendChild(celda);
                }
                tablaHeader.appendChild(primeraFila);
                tabla.appendChild(tablaHeader);
                //llenar cuerpo de tabla
                for (let i = 1; i < obj.length; i++) {
                    let fila = document.createElement('tr');
                    for (let j = 0; j < obj[i].length; j++) {
                        let celda = document.createElement('td');
                        celda.textContent = obj[i][j];
                        fila.appendChild(celda);
                    }
                    tablaBody.appendChild(fila);

                }
                // agregamos css al header
                tablaHeader.classList.add('table-dark')
                //agregamos el cuerpo a la tabla
                tabla.appendChild(tablaBody);
                //agregarmos clases a la tabla
                tabla.classList.add('table','table-bordered','border', 'border-4');
                //  agregamos la tabla a la pagina web
                document.getElementById('divContactos').appendChild(tabla);
                //mostrar notificacion de ok
                crearNotificacion(NOTIFICACION_OK,'Datos Cargados','Contactos');
            }
    function crearTablaContactosError()
    {
        //mostrar notificacion de error
        crearNotificacion(NOTIFICACION_DANGER,'Hubo un error de carga de datos','Contactos');
    }
    function crearNotificacion (tipo,mensaje,titulo)
    {
        //ontener los datos
        let mensajeNotificacion = document.getElementById('MensajeNotificacion');
        let tituloNotificacion = document.getElementById('tituloNotificacion');
        let elementoNotificacion = document.getElementById('notificacion');
        let iconoNotificacion = document.getElementById('iconoNotificacion');
        let notificacion = bootstrap.Toast.getOrCreateInstance(elementoNotificacion);
        //editar notificacion
        mensajeNotificacion.textContent = mensaje;
        tituloNotificacion.textContent=titulo;
         
        switch(tipo)
        {
            case NOTIFICACION_OK:
            iconoNotificacion.className ='';
            iconoNotificacion.classList.add('bi', 'bi-check2-square');       
            elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--color-verde-oscuro');
            break;

            case NOTIFICACION_DANGER:
            iconoNotificacion.className ='';
            iconoNotificacion.classList.add('bi', 'bi-bug');       
            elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--color-rojo-oscuro');
            break;  
            case NOTIFICACION_WARNING:
            iconoNotificacion.className ='';
            iconoNotificacion.classList.add('bi', 'bi-exclamation-square');       
            elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--color-amarillo-oscuro');
            break;           
        }
        // mostrar notificacion
        notificacion.show();
    }

</script>